let
    Source = Table.FromColumns({Lines.FromBinary(File.Contents("C:\Users\user\Pictures\Screenshots\WhatsApp Chat with Young Data Professionals.txt"), null, null, 1252)}),
    #"Removed Blank Rows" = Table.SelectRows(Source, each not List.IsEmpty(List.RemoveMatchingItems(Record.FieldValues(_), {"", null}))),
    #"Split Column by Delimiter" = Table.SplitColumn(#"Removed Blank Rows", "Column1", Splitter.SplitTextByEachDelimiter({","}, QuoteStyle.Csv, false), {"Column1.1", "Column1.2"}),
    #"Changed Type" = Table.TransformColumnTypes(#"Split Column by Delimiter",{{"Column1.1", type text}, {"Column1.2", type text}}),
    #"Split Column by Delimiter1" = Table.SplitColumn(#"Changed Type", "Column1.2", Splitter.SplitTextByEachDelimiter({"-"}, QuoteStyle.Csv, false), {"Column1.2.1", "Column1.2.2"}),
    #"Changed Type1" = Table.TransformColumnTypes(#"Split Column by Delimiter1",{{"Column1.2.1", type text}, {"Column1.2.2", type text}}),
    #"Split Column by Position" = Table.SplitColumn(#"Changed Type1", "Column1.2.2", Splitter.SplitTextByPositions({0, 18}, false), {"Column1.2.2.1", "Column1.2.2.2"}),
    #"Changed Type2" = Table.TransformColumnTypes(#"Split Column by Position",{{"Column1.2.2.1", type text}, {"Column1.2.2.2", type text}}),
    #"Filtered Rows" = Table.SelectRows(#"Changed Type2", each ([Column1.2.2.1] <> null)),
    #"Added Conditional Column" = Table.AddColumn(#"Filtered Rows", "Custom", each if Text.EndsWith([Column1.1], "2") then [Column1.1] else "Others"),
    #"Filtered Rows1" = Table.SelectRows(#"Added Conditional Column", each ([Custom] <> "Others")),
    #"Renamed Columns" = Table.RenameColumns(#"Filtered Rows1",{{"Column1.1", "date"}, {"Column1.2.1", "time"}}),
    #"Reordered Columns" = Table.ReorderColumns(#"Renamed Columns",{"date", "Column1.2.2.1", "time", "Column1.2.2.2", "Custom"}),
    #"Filtered Rows2" = Table.SelectRows(#"Reordered Columns", each true),
    #"Split Column by Delimiter2" = Table.SplitColumn(#"Filtered Rows2", "Column1.2.2.1", Splitter.SplitTextByEachDelimiter({":"}, QuoteStyle.Csv, false), {"Column1.2.2.1.1", "Column1.2.2.1.2"}),
    #"Changed Type3" = Table.TransformColumnTypes(#"Split Column by Delimiter2",{{"Column1.2.2.1.1", type text}, {"Column1.2.2.1.2", type text}}),
    #"Removed Columns" = Table.RemoveColumns(#"Changed Type3",{"Column1.2.2.1.2"}),
    #"Filtered Rows3" = Table.SelectRows(#"Removed Columns", each ([Column1.2.2.1.1] <> " Messages and call" and [Column1.2.2.1.1] <> " You joined using ")),
    #"Renamed Columns1" = Table.RenameColumns(#"Filtered Rows3",{{"Column1.2.2.1.1", "member"}, {"Column1.2.2.2", "Message"}}),
    #"Added Conditional Column1" = Table.AddColumn(#"Renamed Columns1", "Custom.1", each if Text.Contains([Message], "joined") then 1 else 0),
    #"Renamed Columns2" = Table.RenameColumns(#"Added Conditional Column1",{{"Custom.1", "join"}}),
    #"Added Conditional Column2" = Table.AddColumn(#"Renamed Columns2", "Custom.1", each if Text.Contains([Message], "remove") then 1 else 0),
    #"Renamed Columns3" = Table.RenameColumns(#"Added Conditional Column2",{{"Custom.1", "remove"}}),
    #"Removed Columns1" = Table.RemoveColumns(#"Renamed Columns3",{"Custom"}),
    #"Split Column by Delimiter3" = Table.SplitColumn(#"Removed Columns1", "time", Splitter.SplitTextByEachDelimiter({":"}, QuoteStyle.Csv, false), {"time.1", "time.2"}),
    #"Changed Type4" = Table.TransformColumnTypes(#"Split Column by Delimiter3",{{"time.1", Int64.Type}, {"time.2", Int64.Type}}),
    #"Renamed Columns4" = Table.RenameColumns(#"Changed Type4",{{"time.2", "mins"}, {"time.1", "hours"}}),
    #"Filtered Rows4" = Table.SelectRows(#"Renamed Columns4", each true),
    #"Added Conditional Column3" = Table.AddColumn(#"Filtered Rows4", "Custom", each if [member] = " +234 810 852 2573" then "Opeyemi" else if [member] = " +234 706 439 6712" then "Benny-K" else if [member] = " +234 703 316 7142" then "Ability" else if [member] = " +234 703 806 5681" then "Bumblebee" else if [member] = " +234 708 145 1890" then "Iyiola_daniel" else if [member] = " +234 818 368 5814" then "Ace innovation" else if [member] = " +234 810 878 6913" then "Motivator Joshua" else if [member] = " +234 818 047 2075" then "Kolapo" else if [member] = " +234 810 831 6393" then "Prince_analyst" else if [member] = " +234 816 484 7452" then "Tee" else [member]),
    #"Renamed Columns5" = Table.RenameColumns(#"Added Conditional Column3",{{"Custom", "Top(10)"}, {"date", "Date"}, {"member", "Member"}, {"join", "Join"}, {"remove", "Remove"}, {"hours", "Hours"}, {"mins", "Mins"}})
in
    #"Renamed Columns5"
